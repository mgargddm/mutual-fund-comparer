<!DOCTYPE html>
<html>
<head>
    <title>Mutual Fund Comparison</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f6f8;
        }

        .container {
            width: 420px;
            margin: 80px auto;
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #2c3e50;
        }

        p {
            text-align: center;
            color: #555;
        }

        label {
            font-weight: bold;
        }

        input {
            width: 100%;
            padding: 10px;
            margin-top: 6px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        button {
            width: 100%;
            padding: 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            margin-top: 15px;
            font-size: 16px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        .result-box {
            margin-top: 20px;
            padding: 12px;
            background-color: #eef3f7;
            border-radius: 4px;
        }
.suggestions {
    border: 1px solid #ccc;
    max-height: 150px;
    overflow-y: auto;
    background: white;
    position: absolute;
    width: 100%;
    z-index: 10;
}

.suggestion-item {
    padding: 8px;
    cursor: pointer;
}

.suggestion-item:hover {
    background-color: #f0f0f0;
}

    </style>
</head>

<body>

    <div class="container">
        <h1>Mutual Fund Comparison</h1>
        <p>Compare two Indian mutual funds easily</p>

        <div style="position: relative;">
    <input type="text" id="fund1" placeholder="Start typing fund name..." onkeyup="showSuggestions('fund1')">
    <div id="fund1-suggestions" class="suggestions"></div>
</div>

       <br>

<label>Mutual Fund 2</label>
<div style="position: relative;">
    <input type="text" id="fund2" placeholder="Start typing fund name..." onkeyup="showSuggestions('fund2')">
    <div id="fund2-suggestions" class="suggestions"></div>
</div>

        <button onclick="compareFunds()">Compare Funds</button>

        <div class="result-box">
            <p id="result">No comparison done yet.</p>
        </div>
    </div>

   <script>
    let allFunds = [];

    async function loadFunds() {
        const response = await fetch("https://api.mfapi.in/mf");
        allFunds = await response.json();
    }
    loadFunds();

    function showSuggestions(inputId) {
        const input = document.getElementById(inputId);
        const query = input.value.toLowerCase();
        const box = document.getElementById(inputId + "-suggestions");

        box.innerHTML = "";
        if (query.length < 3) return;

        allFunds
            .filter(f => f.schemeName.toLowerCase().includes(query))
            .slice(0, 5)
            .forEach(fund => {
                const div = document.createElement("div");
                div.className = "suggestion-item";
                div.innerText = fund.schemeName;
                div.onclick = () => {
                    input.value = fund.schemeName;
                    box.innerHTML = "";
                };
                box.appendChild(div);
            });
    }

    function findSchemeByName(name) {
        return allFunds.find(f => f.schemeName === name);
    }

    async function fetchNAVData(schemeCode) {
        const response = await fetch("https://api.mfapi.in/mf/" + schemeCode);
        const data = await response.json();
        return data.data;
    }

    function calculateReturn(navData, years) {
        const latest = navData[0];
        const targetDate = new Date();
        targetDate.setFullYear(targetDate.getFullYear() - years);

        const past = navData.find(entry =>
            new Date(entry.date.split("-").reverse().join("-")) <= targetDate
        );

        if (!past) return "NA";

        const latestNAV = parseFloat(latest.nav);
        const pastNAV = parseFloat(past.nav);

        return (((latestNAV - pastNAV) / pastNAV) * 100).toFixed(2);
    }

    async function compareFunds() {
        const fund1Name = document.getElementById("fund1").value;
        const fund2Name = document.getElementById("fund2").value;

        const fund1 = findSchemeByName(fund1Name);
        const fund2 = findSchemeByName(fund2Name);

        if (!fund1 || !fund2) {
            document.getElementById("result").innerText =
                "Please select funds from suggestions.";
            return;
        }

        document.getElementById("result").innerText =
            "Calculating returns...";

        const nav1 = await fetchNAVData(fund1.schemeCode);
        const nav2 = await fetchNAVData(fund2.schemeCode);

        const fund1_1y = calculateReturn(nav1, 1);
        const fund1_3y = calculateReturn(nav1, 3);

        const fund2_1y = calculateReturn(nav2, 1);
        const fund2_3y = calculateReturn(nav2, 3);

        document.getElementById("result").innerText =
            fund1.schemeName + "\n" +
            "1Y Return: " + fund1_1y + "%\n" +
            "3Y Return: " + fund1_3y + "%\n\n" +
            fund2.schemeName + "\n" +
            "1Y Return: " + fund2_1y + "%\n" +
            "3Y Return: " + fund2_3y + "%";
    }
</script>






</body>
</html>